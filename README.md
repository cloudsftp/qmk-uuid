# UUIDv4 generator for QMK keyboards


This is a super limited implementation of a UUIDv4 generator.
It will produce a valid [variant 1 (`10x`)](https://datatracker.ietf.org/doc/html/rfc4122#section-4.1.1) [version 4](https://datatracker.ietf.org/doc/html/rfc4122#section-4.1.3) UUID like the following one:
```
77975cfe-e76c-4320-a4cc-2bb8fc272e5
```
This one was generated by my keyboard.

## Compatibility

This implementation was built for the QMK firmware, but it can theoretically be used by anything that you can compile this library for.
You are required to provide some entropy, this makes it more portable but also requires you to do some of the heavy lifting.
I suggest using any type of clock or timer.

## Usage

Simply call
```
char* your_uuid = random_uuid_string(seed);
```
with a seed of your choice (unsigned int).

Don't forget to free the memory after using the UUID!!!
```
free(your_uuid);
```

### QMK

Some QMK specific usage instructions and tips.

### Installation / Setup

1. Clone this library somewhere.
   I would suggest `~/qmk_firmware/keyboards/uuid`
2. Add that path to the `rules.mk` of the keymap you want to add this feature to.
   Like this: `SRC += uuid/uuid.c`

### Calling the library

I am using it for a custom key event to send out the UUID string.
See [this documentation](https://github.com/qmk/qmk_firmware/blob/master/docs/feature_macros.md#using-macros-in-c-keymaps) about macros.

The following code gets called on the custom key event:
```
void output_uuid(keyrecord_t *record) {
    if (!record->event.pressed) {
        return;
    }

    unsigned int seed = timer_read();
    char* uuid_string = random_uuid_string(seed);

    SEND_STRING(uuid_string);

    free(uuid_string);
}
```

### Getting Entropy

I am using the [timer provided by TMK](https://github.com/tmk/tmk_keyboard/blob/master/tmk_core/common/timer.h).
It might be available for your keyboard too - no guarantee.

I also needed to start the timer, so I run
```
timer_init()
```
at the end of the `keyboard_pre_init_kb` function in the main file of the keyboard I am using ([keyboards/voyager/voyager.c](https://github.com/cloudsftp/qmk-zsa/blob/96729e86e090101aeb6b358b845f7d3ef75ad5e3/voyager/voyager.c#L93)).
This sounded about right.
Just put it somewhere, where it gets run once on startup or smth.

## Warranty

THERE IS NO WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.
EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM “AS IS” WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU. SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR CORRECTION.

